<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile - Pokemon GO Web Store</title>
    <link rel="icon" href="pokeball.png">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="profile.css">
</head>
<body class="body-background">
    <div class="profile-container">
        <div class="profile-header">
            <h1 class="profile-title" id="profile-name"></h1>
            <button class="sign-out-button" onclick="signOut()">Sign Out</button>
        </div>
        
        <div class="trainer-id">
            ID: <span id="trainer-id"></span>
        </div>

        <div class="transaction-history">
            <h2>Transaction history</h2>
            <div id="transaction-list">
                <!-- Transactions will be populated here -->
                <div class="no-transactions">No transaction history</div>
            </div>
        </div>

        <div class="text-center">
            <a href="userHome.html" class="store-button">Return to Store</a>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const currentUser = JSON.parse(localStorage.getItem('currentUser'));
            if (!currentUser) {
                window.location.href = 'SignIn.html';
                return;
            }

            document.getElementById('profile-name').textContent = currentUser.username;
            document.getElementById('trainer-id').textContent = currentUser.userId;

            // Display transaction history if exists
            if (currentUser.purchaseHistory && currentUser.purchaseHistory.length > 0) {
                const transactionList = document.getElementById('transaction-list');
                transactionList.innerHTML = ''; // Clear no transactions message
                
                currentUser.purchaseHistory.forEach(purchase => {
                    const purchaseElement = document.createElement('div');
                    purchaseElement.className = 'purchase-item p-3 mb-3 bg-light rounded';
                    purchaseElement.innerHTML = `
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <h5 class="mb-1">${purchase.name}</h5>
                                <small class="text-muted">${purchase.date}</small>
                            </div>
                            <span class="price-display">${purchase.price}</span>
                        </div>
                    `;
                    transactionList.appendChild(purchaseElement);
                });
            }
        });

        function signOut() {
            localStorage.removeItem('currentUser');
            window.location.href = 'index.html';
        }
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>